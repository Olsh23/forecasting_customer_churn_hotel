# Прогнозирование оттока клиентов в сети отелей

Чтобы привлечь клиентов, эта сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Однако если клиент отменял бронирование, то компания терпела убытки. Сотрудники отеля могли, например, закупить продукты к приезду гостя или просто не успеть найти другого клиента.

Чтобы решить эту проблему, нужно разработать систему, которая предсказывает отказ от брони. Если модель покажет, что бронь будет отменена, то клиенту предлагается внести депозит. Размер депозита — 80% от стоимости номера за одни сутки и затрат на разовую уборку. Деньги будут списаны со счёта клиента, если он всё же отменит бронь.

**Обзор данных**

На вход поступило 2 сета данных с одинаковыми колонками с информацией о бронированиях номеров, в одном больше 65_000 строк, в другом - больше 32_000. Пропусков и дубликатов в данных не было.

Требовалось привести тип данных в колонках с количеством дней между датой бронирования и датой прибытия, количеством взрослых постояльцев, детей от 3 до 14 лет и младенцев к целому числу. Так же для удобства были приведены к целому числу и названия месяцев.

Исследовательский анализ данных выявиил следующие проблемы:
- в значениях столбцов с опциями заказа и типом забронированной комнаты есть лишние пробелы (их было необходимо удалить);
- выбросы в столбцах с необходимостью места для парковки (21) - тип значений приведен к бинарному, с кол-вом младенцев (2) - в тестовой выборке - были удалены;
- в столбце со значениями ожидания подтверждения было много значений больших месяца, скорее всего это говорит о сбоях в системе.

Так же исследовательский анализ данных выявил следующие особенности:
- пик кол-ва броней в обучающей выборке приходится на август, а в тестовой - на май. Так же по обучающей выборке видно, что клиенты для заезда в отель предпочитают месяцы сентябрь и октябрь;
- распределения заездов по неделям имееют тот же самый вид, что и распределения заездов по месяцам;
- заезды по дням в обоих датасетах распределены практически равномерно, есть небольшие пики заездов 5 и 17 числа в обучающей выборке и 2, 9 и 15 - в тестовой;
- большинство клиентов дополнительно включают в свой заказ завтрак, очень малое кол-во людей включают и завтрак, и обед, и ужин. Так же стоит отметить, что в обучающей выборке на втором месте по популярности стоит опция по добавлению завтрака и обеда, а в тестовой - не выбирают ничего;
- самый популярный канал дистрибуции заказа ТА/ТО, наименее - GDS;
- больше всего бронируют комнаты типа А - самый дорогой вариант, меньше всего - комнаты типа В, C, F и G. На втором месте находится комната типа и D.
- большинство клиентов не связано с договором или групповым заездом, чуть меньше - не связано с договором или групповым заездом, но связано с бронированием типа Transient. Меньше всего клиентов группового заезда;
- клиенты отеля имеют 155 национальностей, больше всего в обоих выборках португальцев. На втором месте в обучающей - Франция, в тестовой - Великобритания;
- в обоих выборках не отмененных заказов больше, чем отмененных;
- в обоих выборках больше тех клиентов, которые бронируют номер первый раз;
- в обоих выборках больше тех клиентов, которые остаются в выходные на ночь либо на 1, либо на 2 дня;
- в обоих выборках в будние дни клиенты чаще остаются на 1, 2 или 3 дня;
- в обоих выборках клиенты чаще всего остаются на 1, 2, 3 или 4 ночи;
- большинство клиентов не нуждается в парковочном месте;
- кол-во взрослых постояльцев чаще всего равно 2 или 1;
- чаще всего гости засляются без детей от 3 до 14 лет;
- чаще всего взрослые клиенты заселяются без младенцев;
- чаще всего клиенты бронируют номера примерно за месяц до прибытия;
- в обоих выборках чаще всего клиенты не отменяют заказы;
- большинство клиентов в базе не имеют подтвержденных заказов, возможно это связано с тем, что клиенты новые или название столбца неправильно интерпретировано;
- в обоих выборках заказ подтверждается в основном в первые сутки после бронирования;
- в обоих датасетах клиенты в основном не меняют параметры брони;
- в обоих выборках большинство клиентов не имеют специальных отметок, у чуть меньшего кол-во клиентов есть либо 1, либо 2.

**Разработка модели**

Предсказание того, отменит ли бронь человек - задача классификации.

Для корректной работы моделей было проведено кодирование категориальных столбцов: `meal`, `country`, `customer_type`, `reserved_room_type`, `distribution_channel` и `arrival_date_month`, а так же было проведено масштабирование колличественных переменных.

В проекте рассмотрено 3 модели машинного обучени:
- модель дерева решений;
- модель случайного леса;
- модель логистической регрессии.

Качество моделей оценено методом кросс-валидацией, сравнение проводилось с использованием метрики F1-меры - среднее гармоническое полноты и точности.

Большее значение F1-меры показала модель дерева решений - 0.69.

**Решение бизнес-задачи**

Прибыль без внедрения модели и депозита составила: 32_582_920 руб..

Выбранная модель машинного обучения смогла окупиться за тестовый период и превзойти значение прибыли без депозита. Ее прибыль составила 39_706_848 руб..

Так же на основе исследовательского анализа данных, клиент, у которого есть все ниже перечисленные факторы, будет являтся ненадежным (факторы перечислены в порядке уменьшения значимости: от наиболее значимого к наименее значимому) :
- Бронирует больше чем за 4 месяца до прибытия;
- Не имеет специальных отметок;
- Имеет много случаев отмены заказа в прошлом;
- Ждет подтверждения заказа больше 2 дней.